import Docxtemplater, { DXT } from "docxtemplater";
import InspectModule from "./inspect-module";
import angularParser from "../expressions";
import ieAngularParser from "../expressions-ie11";
import TxtTemplater from "./text";
import PizZip from "pizzip";

const tDoc = new TxtTemplater("Hello {#users}{name},{/users} how are you ?", {
  parser: angularParser,
});
tDoc.render({ users: [{ name: "John" }, { name: "Baz" }] });

angularParser.filters.map = function (input: any, key: any): any {
  if (!input) {
    return input;
  }

  if ("map" in input) {
    return input.map(function (x: any) {
      return x[key];
    });
  }
};

ieAngularParser.filters.map = function (input: any, key: any): any {
  if (!input) {
    return input;
 
