"use strict";

module.exports = {
  on: function on(eventName) {
    if (eventName === "attached") {
      this.attached = false;
    }
  },
  postparse: function postparse(postparsed, { filePath }) {
    // Check if postparsed is an array
    if (!Array.isArray(postparsed)) {
      throw new Error("postparse function expects an array as first argument");
    }

    // Validate filePath
    if (filePath !== "word/settings.xml") {
      return null;
    }

    try {
      // Map through the postparsed array
      return postparsed.map(part => {
        if (part.type === "tag" && part.tag === "w:proofState") {
          return {
            type: "content",
            value: ""
          };
        }
        return part;
      });
    } catch (error) {
      // Handle any errors that occur during the map operation
      console.error("Error in postparse function:", error);
      return null;
    }
  }
};
